<div class="page-container">
  <div class="page-header">
    <h2>Stock Inward</h2>
    <p>Manage inward stock transactions</p>
  </div>
  
  <div class="expandable-panel">
    <div class="panel-header" (click)="toggleStockInwardPanel()">
      <h3>Stock Inward</h3>
      <button class="toggle-btn" type="button">
        <svg class="toggle-icon" [class.rotated]="isStockInwardPanelExpanded()" viewBox="0 0 24 24" fill="currentColor">
          <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
        </svg>
      </button>
    </div>
    <div class="panel-content" [class.expanded]="isStockInwardPanelExpanded()">
      <div class="inward-form-container">
        <form class="inward-form">
          <div class="controls-grid-row" style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 16px; align-items: center;">
            <div>
              <label style="margin-bottom:8px; display:block;">Inward Type:</label>
              <label style="display:block; margin-bottom:10px; margin-left:12px;"><input type="radio" name="inwardType" [(ngModel)]="inwardType" value="Single" style="margin-right:8px;" /> Single</label>
              <label style="display:block; margin-left:12px;"><input type="radio" name="inwardType" [(ngModel)]="inwardType" value="Bulk" style="margin-right:8px;" /> Bulk</label>
            </div>
            <div>
              <label for="stockType" style="margin-bottom:8px; display:block;">Stock Type:</label>
              <select id="stockType" [(ngModel)]="stockType" name="stockType" style="margin-top:4px; width:180px;">
                <option value="Container">Container</option>
                <option value="Single Item">Single Item</option>
              </select>
            </div>
            <div>
              <label for="category" style="margin-bottom:8px; display:block;">Category:</label>
              <select id="category" [(ngModel)]="category" name="category" style="margin-top:4px; width:180px;">
                <option value="">Select Category</option>
                <option *ngFor="let cat of categories; trackBy: trackById" [value]="cat.id">{{cat.name}}</option>
              </select>
            </div>
            <div *ngIf="inwardType === 'Bulk'">
              <label for="bulkQty" style="margin-bottom:8px; display:block;">Bulk Qty:</label>
              <input id="bulkQty" type="number" [(ngModel)]="bulkQty" name="bulkQty" style="width:180px; margin-top:4px;" />
            </div>
            <div *ngIf="inwardType !== 'Bulk'" style="height: 38px;"></div>
          </div>
          <div class="specification-grid">
            <table>
              <thead>
                <tr>
                  <th style="width:120px;">Specification</th>
                  <th style="width:200px;">Value</th>
                  <th style="width:50px;">Lock</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Container ID</td>
                  <td style="text-align:left;">
                    <select [(ngModel)]="containerId" name="containerId" class="spec-dropdown" style="width:100%;" [disabled]="stockType !== 'Container'">
                      <option>Generate</option>
                      <option *ngFor="let container of containers" [value]="container.id">{{container.name}}</option>
                    </select>
                  </td>
                </tr>
                <tr>
                  <td>Item ID</td>
                  <td style="text-align:left;">
                    <select [(ngModel)]="itemId" name="itemId" class="spec-dropdown" style="width:100%;">
                      <option *ngFor="let item of items" [value]="item.id">{{item.name}}</option>
                    </select>
                  </td>
                </tr>
                <tr *ngFor="let spec of filteredSpecifications">
                  <td>{{spec.specificationName}}</td>
                  <td>
                      <div style="display: flex; align-items: center; gap: 8px; width:100%;">
                        <select [(ngModel)]="specValues[spec.specificationName]" name="spec_{{spec.specificationName}}" class="spec-dropdown" style="flex:1; min-width:0;">
                          <option *ngFor="let option of getSpecOptions(spec.specificationName)" [value]="option.id">{{option.name}}</option>
                        </select>
                      </div>
                  </td>
                  <td>
                    <div *ngIf="spec.lockable === true" style="display: flex; align-items: center; gap: 8px; width:100%;">
                      <input type="checkbox" [(ngModel)]="specChecked[spec.specificationName]" name="specCheck_{{spec.specificationName}}" style="width:16px; height:16px; margin-left:8px;" />
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>